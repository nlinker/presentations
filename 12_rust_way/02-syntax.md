### ‚Ññ2. –ü–æ—á–µ–º—É —É –†–∞—Å—Ç–∞ —Ç–∞–∫–æ–π —à—É–º–Ω—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å?

–û–±—ã—á–Ω–æ –ø—Ä–∏–≤–æ–¥—è—Ç—Å—è —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã
```rust
pub fn read<P: AsRef<Path>>(path: P) -> io::Result<Vec<u8>> {
  fn inner(path: &Path) -> io::Result<Vec<u8>> {
    let mut file = File::open(path)?;
    let mut bytes = Vec::new();
    file.read_to_end(&mut bytes)?;
    Ok(bytes)
  }
  inner(path.as_ref())
}
```
(—ç—Ç–æ—Ç –∫–æ–¥ –≤–∑—è—Ç –∏–∑ [—Å—Ç–∞—Ç—å–∏ —Ç–æ–≤. Matklad](https://matklad.github.io/2023/01/26/rusts-ugly-syntax.html))
<img src="slides/03/qr_matklad.png" height=150 alt="qr_matklad.png"></img>

---------------------------------------------------------------------------------------------------


#### –ù–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π —è–∑—ã–∫!

1. –í —Ñ—É–Ω–∫—Ü–∏–∏ `read` –ø–∞—Ä–∞–º–µ—Ç—Ä `path` –æ–±–æ–±—â—ë–Ω–Ω—ã–π
2. –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è —Ñ—É–Ω–∫—Ü–∏—è `inner` –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è rustc 
3. –°–ª–æ–∂–Ω—ã–π –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—ã–π —Ç–∏–ø –¥–ª—è –æ–ø–∏—Å–∞–Ω–∏—è —Ç–∏–ø–∞ –æ—à–∏–±–∫–∏
4. `file.read_to_end(&mut bytes)`

```rust
pub fn read<P: AsRef<Path>>(path: P) -> io::Result<Vec<u8>> {
  fn inner(path: &Path) -> io::Result<Vec<u8>> {
    let mut file = File::open(path)?;
    let mut bytes = Vec::new();
    file.read_to_end(&mut bytes)?;
    Ok(bytes)
  }
  inner(path.as_ref())
}
```
---------------------------------------------------------------------------------------------------


#### –ë–µ–∑ —ç—Ç–∏—Ö –¥–µ—Ç–∞–ª–µ–π –∫–æ–¥ —É–ø—Ä–æ—â–∞–µ—Ç—Å—è!

```rust
pub fn read(path: Path) -> Bytes {
  let file = File::open(path);
  let bytes = Bytes::new();
  file.read_to_end(bytes);
  bytes
}
```
–ú–æ–∂–Ω–æ –µ—â—ë:
1. –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –∏–∑–±–∞–≤–∏—Ç—å—Å—è –æ—Ç `;` –Ω–∞ –∫–æ–Ω—Ü–∞—Ö —Å—Ç—Ä–æ–∫
2. –°–¥–µ–ª–∞—Ç—å —Ç–∞–∫, —á—Ç–æ–±—ã `File::open(path)` –≤—ã–≥–ª—è–¥–µ–ª –∫–∞–∫ `File.open(path)`
3. –°–¥–µ–ª–∞—Ç—å —Ç–∞–∫, —á—Ç–æ–±—ã –Ω–µ –±—ã–ª–∏ –Ω—É–∂–Ω—ã `let` 

---------------------------------------------------------------------------------------------------


#### –¢–æ—á–∫–∏-—Å-–∑–∞–ø—è—Ç–æ–π `;`

- –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–º–æ—Ç—Ä–µ–ª–∏ –Ω–∞ Js, Python, Scala, Haskell
- –°–ª—É—á–∞–π–Ω—ã–π –ø–µ—Ä–µ–≤–æ–¥ —Å—Ç—Ä–æ–∫–∏ –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å –ª–æ–≥–∏–∫—É
- –í expression-based —è–∑—ã–∫–∞—Ö –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –Ω–∏–∂–µ —Å—Ç—Ä–æ—á–∫–æ–π –º–æ–∂–µ—Ç —É–¥–ª–∏–Ω–∏—Ç—å –≤—Ä–µ–º—è –∂–∏–∑–Ω–∏ –æ–±—ä–µ–∫—Ç–æ–≤
```js
return
  a + b
```
```rust
fn test1() {
    a
    [b] // a[b] –∏–ª–∏ a; [b], —Å–∫–æ–ª—å–∫–æ –±—É–¥–µ—Ç –∂–∏—Ç—å a?
}
fn test2() {
    a
    ::b // a::b –∏–ª–∏ a; ::b?
}
fn test3() {
    a
    - b // a - b –∏–ª–∏ a; -b ?
}
fn test4() {
    break
    a // break a –∏–ª–∏ break; a?
}
```
---------------------------------------------------------------------------------------------------


#### –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ

* `expr` –≤—ã—á–∏—Å–ª—è–µ—Ç –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤—ã—á–∏—Å–ª–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
* `expr;` –≤—ã—á–∏—Å–ª—è–µ—Ç –≤—ã—Ä–∞–∂–µ–Ω–∏–µ, –æ—Ç–±—Ä–∞—Å—ã–≤–∞–µ—Ç –≤—ã—á–∏—Å–ª–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `()`
* `;` —ç—Ç–æ –∏ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å, –∏ –ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–æ–≥ —Ñ—É–Ω–∫—Ü–∏–∏ `void`:
```rust
fn void(t: T) {
   // –≤—Ä–µ–º—è –∂–∏–∑–Ω–∏ t –ø–æ–¥–æ—à–ª–æ –∫ –∫–æ–Ω—Ü—É
}

fn main() {
   let mut x = X::new();
   let mut y = { Y::new() };
   let mut z = {
      y.func();
      Z::new()
   };
}
```
---------------------------------------------------------------------------------------------------


#### –î–≤–æ–µ–¥–≤–æ–µ—Ç–æ—á–∏—è `::` vs `.`

- –ú–æ–∂–µ—Ç –ª–∏ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –æ–±–æ–π—Ç–∏—Å—å —Ç–æ–ª—å–∫–æ `.` –≤ `File.open(path)`?
- –£–≤—ã:
```rust
struct T {}
impl T {
    fn is_some() {}
}
fn main() {
    let T = Some(1);
    T::is_some(); 
    T.is_some(); // –≤—ã–∑–æ–≤ Option::is_some(&T)
}
```
–°–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ä–∞–∑–Ω—ã–µ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–∏:
- –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –ø–æ –º–æ–¥—É–ª—è–º –∏ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞–º –∏–º—ë–Ω
- –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –ø–æ–ª—è–º –∏ –º–µ—Ç–æ–¥–∞–º

---------------------------------------------------------------------------------------------------


#### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã `::`?

–ß–∏—Å—Ç–æ —ç—Å—Ç–µ—Ç–∏—á–µ—Å–∫–∏ –º–æ–∂–µ—Ç–µ –æ—Ü–µ–Ω–∏—Ç—å, –Ω–∞—Å–∫–æ–ª—å–∫–æ –∫—Ä–∞—Å–∏–≤–µ–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã:
```rust
fn test() -> io::Result<()> {
    let _ = std::env::current_dir().map_err(|_| Error::File("..."))?;

    std:env:current_dir().map_err(|_| Error:File("..."))?; // Erlang
    std/env/current_dir().map_err(|_| Error/File("..."))?; // Nim
    std$env$current_dir().map_err(|_| Error$File("..."))?; // java bc
    std-env-current_dir().map_err(|_| Error-File("..."))?; // :-)
    std^env^current_dir().map_err(|_| Error^File("..."))?; // ^_^
}
```
---------------------------------------------------------------------------------------------------


#### –ò–∑–±–∞–≤–∏—Ç—å—Å—è –æ—Ç `let`?

<pre data-id="code-animation"><code class="hljs cplusplus" data-trim data-line-numbers="|2,4"><script type="text/template">
Framed<FramedWrite<WriteHalf<TcpStream>, 
   LengthDelimitedCodec>, Request, SomeType1, SomeType2> requests = ...;
Framed<FramedRead<ReadHalf<TcpStream>, 
   LengthDelimitedCodec>, Response, SomeType1, SomeType2> responses = ...;
</script></code></pre>
<pre data-id="code-animation"><code class="hljs rust" data-trim data-line-numbers="|4|5|6|1,7|10"><script type="text/template">
type Requests = Framed<FramedWrite<WriteHalf<TcpStream>, LengthDelimitedCodec>, Request, SomeType1, SomeType2>;

fn main() {
    let requests = ...; // –µ—Å–ª–∏ –≤—ã–≤–æ–¥ —Ç–∏–ø–æ–≤ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è
    let requests: Framed<_, _, _, _> = ...; // –µ—Å–ª–∏ –Ω–∞–¥–æ –Ω–µ–º–Ω–æ–≥–æ –ø–æ–º–æ—á—å
    let requests: Framed<_, Request, SomeType1, SomeType2> = ...; // –µ—Å–ª–∏ –Ω–∞–¥–æ —á—É—Ç—å –±–æ–ª—å—à–µ –ø–æ–º–æ—á—å
    let requests: Requests = ...; // –µ—Å–ª–∏ —Ö–æ—á–µ—Ç—Å—è –≤–æ–æ–±—â–µ –∑–∞–º–µ—Å—Ç–∏ —Ç–∏–ø –ø–æ–¥ –∫–æ–≤—ë—Ä 

    // —á–∞—Å—Ç–æ –º–æ–∂–Ω–æ –ø–æ–º–æ—á—å —Å –ø–æ–º–æ—â—å—é —Ç.–Ω. turbofish
    let vec = a_collection.iter().map(|x| ...).collect::<Vec<_>>();
}
</script></code></pre>
(–ö—Å—Ç–∞—Ç–∏, –ª—è–º–±–¥—ã `|x| ...` –ø—Ä–∏—à–ª–∏ –∏–∑ Ruby)

---------------------------------------------------------------------------------------------------


#### –ö–∞–º–µ–Ω—å –≤ –æ–≥–æ—Ä–æ–¥ C++

–ù–µ–æ–¥–Ω–æ–∑–Ω–∞—á–Ω–æ—Å—Ç—å –ø–∞—Ä—Å–∏–Ω–≥–∞:
```—Åpp
template<typename T> class X {
    void foo() {
        T::A* pa;
        // typename T::A* pa; 
    }
} 
```
–¢—Ä—É–¥–Ω–æ—Å—Ç—å –≤–æ—Å–ø—Ä–∏—è—Ç–∏—è —Å–∏–≥–Ω–∞—Ç—É—Ä —Ç–∏–ø–æ–≤:
```cpp
int (*(*foo)(void))[3]
void (*signal(int sig, void (*func)(int)))(int)
char * const (*(* const bar)[5])(int )
```
(https://cdecl.org/ –≤ –ø–æ–º–æ—â—å)

–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ —è–∑—ã–∫–∞ Rust –≥—Ä–∞–º–æ—Ç–Ω–æ –æ–±–æ—à–ª–∏ —ç—Ç–∏ –≥—Ä–∞–±–ª–∏ üëç